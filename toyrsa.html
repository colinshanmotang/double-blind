<!doctype html>
<html>
<head>
  <title>Snarkjs client example</title>
</head>
<body>

  <h1>Snarkjs client example</h1>

 <textarea name="Input inputs here" cols="40" rows="5" id="input-inputs">inputs</textarea>

  <button id="bGenProof"> Create proof </button>

  <textarea name="Input proof here" cols="40" rows="5" id="input-proof">proof</textarea>

  <textarea name="Input public inputs here" cols="40" rows="5" id="input-public">public</textarea>

  <button id="VerifyProof"> Verify proof </button>

  <!-- JS-generated output will be added here. -->
  <pre class="proof"> Proof: <br> <code id="proof"></code></pre>

  <pre class="proof"> Public inputs: <br> <code id="public"></code></pre>

  <pre class="proof"> Result: <br> <code id="result"></code></pre>


  <script src="snarkjs.min.js">   </script>


  <!-- This is the bundle generated by rollup.js -->
  <script>

const proofComponent = document.getElementById('proof');
const publicComponent = document.getElementById('public');
const resultComponent = document.getElementById('result');
const inputProof = document.getElementById('input-proof');
const inputPublic = document.getElementById('input-public');
const inputInputs = document.getElementById('input-inputs');
const bGenProof = document.getElementById("bGenProof");
const vProof = document.getElementById("VerifyProof");

bGenProof.addEventListener("click", calculateProof);
vProof.addEventListener("click", verifyProof);

async function calculateProof() {

    const { proof, publicSignals } =
      await snarkjs.groth16.fullProve( JSON.parse(inputInputs.value), "toyrsa_js/toyrsa.wasm", "toyrsa_0001.zkey");

    proofComponent.innerHTML = JSON.stringify(proof, null, 1);

    publicComponent.innerHTML = JSON.stringify(publicSignals, null, 1);
    
}

async function verifyProof () {
    const vkey = await fetch("verification_key-toyrsa.json").then( function(res) {
        return res.json();
    });

    const publicSignals = JSON.parse(inputPublic.value);

    const proof = JSON.parse(inputProof.value);
    //console.log(vkey, publicSignals, proof);
    const res = await snarkjs.groth16.verify(vkey, publicSignals, proof);
    //console.log("success verify");

    resultComponent.innerHTML = res;
}

  </script>

</body>
</html>